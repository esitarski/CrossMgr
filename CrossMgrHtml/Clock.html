<html>
<head>
<meta charset="UTF-8">
<link rel="icon" type="image/png" href="data:image/png;base64,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" />
<meta name="author" content="Edward Sitarski">
<meta name="copyright" content="Edward Sitarski">
<meta name="generator" content="CrossMgr">  
<meta name="keywords" content="CrossMgr, Cycling, Race, Competition, Results"> 
<title id="idTitle">Time Trial Countdown</title>

<script>

function posToAngle( pos ) {
	return pos*2.0*Math.PI-Math.PI/2.0;
}

var tCos60 = new Array(60), tSin60 = new Array(60);
for( var i = 0; i < 60; ++i ) {
	var a = posToAngle( i/60.0 );
	tCos60[i] = Math.cos(a);
	tSin60[i] = Math.sin(a);
}

function circle( ctx, x, y, r ) {
	ctx.beginPath();
	ctx.arc( x, y, r, 0, 2*Math.PI );
}

function Clock( canvas ) {

	this.canvas = canvas;
	this.tNow = new Date();
	this.keepGoing = true;

	this.onTimer = function() {
		if( this.keepGoing ) {
			this.tNow = new Date();
			this.Draw();
			setTimeout( this.onTimer.bind(this), 1000 - (new Date()).getMilliseconds() );
		}
	};
	
	this.Start = function() {
		this.onTimer();
	};
	
	this.Stop = function() {
		this.keepGoing = false;
	}
		
	this.OnSize = function() {
		this.Draw();
	};
		
	this.Draw = function() {
		if( document.hidden )
			return;
		
		var t = this.tCur || new Date();
		var width = this.canvas.width;
		var height = this.canvas.height-1;
		var middle = Math.min(width, height) / 2;
		var radius = middle * 0.9;
		var xCenter = width/2, yCenter = height/2;
		
		var ctx = this.canvas.getContext("2d");
		
		var backcolor = '#FFFFFF';
		ctx.fillStyle = backcolor;
		ctx.clearRect( 0, 0, this.canvas.width, this.canvas.height );
		
		var rOutside = radius * 0.98;
		var rOutTicks = rOutside;
		var rInMinuteTicks = rOutTicks * 0.95;
		var rInHourTicks = rOutTicks * 0.9;
		var rHour = radius * 0.6;
		var rMinute = (rInMinuteTicks + rInHourTicks) / 2;
		var rSecond = rMinute;
		var rBack = -radius * 0.1;
		var rDot = rSecond * 0.85;
		var dotSize = rDot * 0.08;

		var wMinuteTicks = radius * 0.03;
		var wHourTicks = wMinuteTicks * 2.0;
		
		var wHourHand = wHourTicks * 1.5;
		var wMinuteHand = wHourTicks;
		var wSecondHand = wMinuteHand / 2.0;
		
		//--------------------------------------------------------------
		// Draw the metal ring
		//
		var r = radius * 1.0/0.9;
		
		var rg = ctx.createRadialGradient(
			xCenter, yCenter - r, 0.0,
			xCenter, yCenter - r, r * 2
		);
		rg.addColorStop( 0, '#FFFFFF' );
		rg.addColorStop( 1, '#212121' );
		ctx.fillStyle = rg;

		circle( ctx, xCenter, yCenter, r );
		ctx.fill()
		
		var rSmaller = r * 0.90;
		
		var rg = ctx.createRadialGradient(
			xCenter, yCenter + rSmaller, 0.0,
			xCenter, yCenter + rSmaller, rSmaller * 2
		);
		rg.addColorStop( 0, '#FFFFFF' );
		rg.addColorStop( 1, '#212121' );
		ctx.fillStyle = rg;
		circle( ctx, xCenter, yCenter, rSmaller )
		ctx.fill();
		
		//--------------------------------------------------------------
		// Draw the clock face.
		//
		var rg = ctx.createRadialGradient(
			xCenter, yCenter-radius*0.6, 0.0,
			xCenter, yCenter, rOutside
		);
		rg.addColorStop( 0, '#FCFCFC' );
		rg.addColorStop( 1, '#DCDCDC' );
		ctx.fillStyle = rg;
		circle( ctx, xCenter, yCenter, rOutside );
		ctx.fill();

		ctx.strokeStyle = '#000000';
		ctx.lineCap = 'butt';
		ctx.lineWidth = wMinuteTicks;
		ctx.beginPath();
		for( var i = 1; i < 60; ++i ) {
			if( i % 5 ) {
				ctx.moveTo( xCenter + rInMinuteTicks * tCos60[i], yCenter + rInMinuteTicks * tSin60[i] );
				ctx.lineTo( xCenter + rOutTicks * tCos60[i], yCenter + rOutTicks * tSin60[i] );
			}
		}
		ctx.stroke();
		
		ctx.lineWidth = wHourTicks;
		ctx.beginPath();
		for( var i = 0; i < 60; i += 5 ) {
			ctx.moveTo( xCenter + rInHourTicks * tCos60[i], yCenter + rInHourTicks * tSin60[i] );
			ctx.lineTo( xCenter + rOutTicks * tCos60[i], yCenter + rOutTicks * tSin60[i] );
		}
		ctx.stroke();
			
		//--------------------------------------------------------------
		// Draw the digital clock.
		//
		var textHeight = Math.max(1,radius*0.37);
		ctx.font = textHeight + 'px Arial';
		ctx.fillStyle = '#646464';
		ctx.textAlign = 'end';
		ctx.textBaseline = 'alphabetic';
		var tStr = t.getHours() + ':' + ('0' + t.getMinutes()).slice(-2) + ':' + ('0' + t.getSeconds()).slice(-2);
		var w = ctx.measureText( '00:00:00' ).width;
		ctx.fillText( tStr, xCenter+w/2, yCenter+radius/2-textHeight/8 );
		
		ctx.fillStyle = '#8C8C8C';
		ctx.font = textHeight/3.5 + 'px Arial';
		ctx.textAlign = 'center';
		ctx.textBaseline = 'top';
		ctx.fillText( 'CrossMgr', xCenter, yCenter-rInHourTicks/2 );
		
		//--------------------------------------------------------------
		// Draw the hands.
		//
		var secondPos = (t.getSeconds() + t.getMilliseconds()/1000.0) / 60.0;
		var minutePos = (t.getMinutes() + secondPos) / 60.0;
		var hourPos = (t.getHours() % 12 + minutePos) / 12.0;
		
		ctx.lineCap = 'round';
		ctx.strokeStyle = 'rgba(0,0,180,0.5)';
		ctx.lineWidth = wHourHand;
		var a = posToAngle( hourPos );
		var cosCur = Math.cos(a), sinCur = Math.sin(a);
		ctx.beginPath();
		ctx.moveTo( xCenter + rBack * cosCur, yCenter + rBack * sinCur );
		ctx.lineTo( xCenter + rHour * cosCur, yCenter + rHour * sinCur );
		ctx.stroke();
		
		ctx.strokeStyle = 'rgba(0,150,0,0.5)';
		ctx.lineWidth = wMinuteHand;
		var a = posToAngle( minutePos );
		var cosCur = Math.cos(a), sinCur = Math.sin(a);
		ctx.beginPath();
		ctx.moveTo( xCenter + rBack * cosCur,   yCenter + rBack * sinCur );
		ctx.lineTo( xCenter + rMinute * cosCur, yCenter + rMinute * sinCur );
		ctx.stroke();
		
		ctx.strokeStyle = '#FF0000';
		ctx.fillStyle = '#FF0000';
		ctx.lineWidth = wSecondHand;
		var a = posToAngle( secondPos );
		var cosCur = Math.cos(a), sinCur = Math.sin(a);
		var xDot = xCenter + rDot * cosCur;
		var yDot = yCenter + rDot * sinCur;
		ctx.beginPath();
		ctx.moveTo( xDot, yDot );
		ctx.lineTo( xCenter + rMinute * cosCur, yCenter + rMinute * sinCur );
		ctx.stroke();
		circle( ctx, xDot, yDot, dotSize );
		ctx.fill();
	};
}

function onLoad() {
	clock = new Clock( document.getElementById('myCanvas') );
	clock.Start();
}

</script>
</head>
<body onload="onLoad()">
<canvas id="myCanvas" width="500" height="500"></canvas>
</body>
</html>
