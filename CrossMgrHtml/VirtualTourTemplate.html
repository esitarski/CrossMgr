<html>
<head>
<meta charset="UTF-8">
<link rel="icon" type="image/png" href="data:image/png;base64,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" />
<meta name="author" content="Edward Sitarski">
<meta name="copyright" content="Edward Sitarski">
<meta name="generator" content="CrossMgr">  
<meta name="keywords" content="CrossMgr, Cycling, Race, Results">

<title>CrossMgr Google Map Course</title>
<style type="text/css">
	body { font-family: sans-serif; }
</style>
<script src="https://www.google.com/jsapi"> </script> 
<script type="text/javascript">
function walkKmlDom(rootObject, visitCallback, options) {
  options = options || {};
  
  if (!('features' in options)) {
    options.features = true;
  }
  
  if (!('geometries' in options)) {
    options.geometries = false;
  }
  
  var recurse_ = function(object, currentContext) {
	var contextArgument = {
	  current: currentContext,
	  child: currentContext
	};

	// walk object
	var retValue = visitCallback.call(object, contextArgument);
	if (!retValue && typeof retValue !== 'undefined') {
	  return;
	}

	var objectContainer = null; // GESchemaObjectContainer

	// check if object is a parent
	if ('getFeatures' in object) { // GEFeatureContainer
	  if (options.features) {
		objectContainer = object.getFeatures();
	  }
	} else if ('getGeometry' in object) { // KmlFeature - descend into geoms.
	  if (options.geometries && object.getGeometry()) {
		recurse_(object.getGeometry(), contextArgument.child);
	  }
	} else if ('getGeometries' in object) { // GEGeometryContainer
	  if (options.geometries) {
		objectContainer = object.getGeometries();
	  }
	} else if ('getInnerBoundaries' in object) { // GELinearRingContainer
	  if (options.geometries) {
		objectContainer = object.getInnerBoundaries();
	  }
	}

	// iterate through children if object is a parent and recurse so they
	// can be walked
	if (objectContainer && objectContainer.hasChildNodes()) {
	  var childNodes = objectContainer.getChildNodes();
	  var numChildNodes = childNodes.getLength();
	  
	  for (var i = 0; i < numChildNodes; i++) {
		var child = childNodes.item(i);
		recurse_(child, contextArgument.child);
	  }
	}
  };
  
  recurse_(rootObject, options.rootContext);
};
	  
var kml = '';
var raceName = '';
var organizer = '';
var ge;
var tour;
google.load("earth", "1");
function init() { google.earth.createInstance('map3d', initCB, failureCB); }
function initCB(instance) {
	if( raceName )
		document.getElementById('idRaceName').innerHTML = raceName;
	if( organizer )
		document.getElementById('idOrganizer').innerHTML = 'by ' + organizer;

	ge = instance;
	ge.getWindow().setVisibility(true);
	ge.getNavigationControl().setVisibility(ge.VISIBILITY_SHOW);

	var kmlObj = ge.parseKml( kml.replace(/\{\{/g, '<').replace( /\}\}/g, '>') );
	kml = 'empty';
	
	ge.getFeatures().appendChild( kmlObj );
	ge.getLayerRoot().enableLayerById(ge.LAYER_BUILDINGS_LOW_RESOLUTION, true);

	walkKmlDom(kmlObj, function() {
		  if (this.getType() == 'KmlTour') {
			 tour = this;
			 return false;
	   }
	});
	enterTour();
	playTour();
 }

function failureCB(errorCode) {}

function enterTour() {
	if (!tour) {
		alert('No tour found!');
		return;
	}
	ge.getTourPlayer().setTour(tour);
 }
function playTour() { ge.getTourPlayer().play(); }
function pauseTour() { ge.getTourPlayer().pause(); }
function resetTour() { ge.getTourPlayer().reset(); }
google.setOnLoadCallback(init);
</script>
</head>
<body>
	<h1 id="idRaceName">Accessing Map Data. Please be patient...</h1>
	<span id="idOrganizer">by CrossMgr</span>
	<p/>
	<div id="map3d" style="height: 600px; width: 1000px;"></div>
	<p/>
	Powered by <a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a>.
</body>
</html>
